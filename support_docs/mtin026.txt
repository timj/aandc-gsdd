Refraction                                                                Page 1
MTIN026


SCIENCE AND ENGINEERING RESEARCH COUNCIL                               MT/IN.026
CAVENDISH LABORATORY
MULLARD RADIO ASTRONOMY OBSERVATORY


MT Project                                                             Issued by
MT Note IN.026

                                                                    S.Kenderdine
                                                                       I.Coulson
                                                                    J.Fairclough

                                                                    2 March 1988

--------------------------------------------------------------------------------


                                   __________                                   Refraction


                                      NOTE


             The first edition of  this  note  was  produced  by  Sidney
        Kenderdine  in  August 1986.  In the second edition the research
        by Iain Coulson on refraction is described.
             Kenderdine's approach appears in section 1,  Coulson's  and
        its implementation by Jon Fairclough, in section 2.





1  First Model


1.1  Introduction


     Atmospheric refraction increases the apparent elevation of an  astronomical
object  above the geometrical elevation by an amount which increases with zenith
angle.  For objects above about 10 degrees elevation the functional form of  the
correction is

        da1 = aa - ag = zg - za = A tan(zg) + B (tan(zg))**3     ..... (1)

where aa and ag are the apparent and  geometrical  elevations,  za  and  zg  the
corresponding  zenith  angles,  and  A  and B constants.  At low elevations, the
following empirical formula

        da2 = C/(ag+D)    .............................................(2)

                                     - 1 -
Refraction                                                                Page 2
MTIN026


gives a reasonable fit to Bessel's  table  (Norton  Star  Atlas,  page  x)  with
constants C = 70 arcmin, D = 2 degrees and ag in degrees.

     The routine drive_refg2a(ag,aa) computes the apparent  altitude  aa  for  a
given  geometrical  altitude  ag;  it  adopts different algorithms for different
ranges of ag as follows:

       For ag greater than some value ag2 (currently 8  degrees),  use
          formula (1) above; this will be the common case.

       For ag between 0 and some value ag1 (currently 4  degrees,  and
          in any case less than ag2), use formula (2).

       For ag between ag1 and ag2, take the weighted  mean  of  values
          from both formulae, the weighting varying linearly with ag.

       For ag negative, use C/D, i.e.  the value for  the  geometrical
          horizon.

     The inverse routine drive_refa2g(aa,ag)  operates  by  using  the  forwards
routine on a trial and error basis; 2 or 3 iterations are usually ample.

     The above scheme is not intended to be accurate for low elevations.  It  is
provided  as something which (a) gives smoothly and monotonically varying values
wrt elevation over the whole range, and (b) is rigorously invertible.




1.2  CDA, Telescope.dat Entries


     The only parameters accessible to the user are in telescope.dat and are the
three constants A, B and C in arcsecs.

     The parameters D, ag1 and ag2 are fixed by program at 2, 4 and  8  degrees.
To  change  them edit drive_geom_init (or its successor) to give new settings of
ndeg4, ndeg5 and ndeg6 (which give the values in degrees).  This  is  admittedly
clumsy, but changes at this level are likely to involve changes to the algorithm
as well as to the constants, and neater access seems unnecessary.

     The CDA entries are in 'refraction' (10 x real*8) generated by  TEL2.   The
contents are
 Item   Contents                                                Set up by
                                                              (srr of TEL2)

 1      A (radians)                                             tfile

 2      B (radians)                                             tfile

 3      C )  C and D are set up so that C/(ag+D) gives the      geomin

                                     - 2 -
Refraction                                                                Page 3
MTIN026


 4      D )  correction in radians for ag in radians            geomin

 5      ag1 (radians)                                           geomin
 6      ag2 (radians)                                           geomin

 7      refraction at horizon (radians)                         geomin


Note that item 3 is

(refraction at horizon/arcsec) * (D/degrees) * (const_sa2r) * (const_d2r)





2  Second Model


2.1  Description


A model has been constructed for the purposes of determining  an  algorithm  for
calculating   refraction  from  JCMT,  and  have  derived  such  algorithms  for
wavelengths of 1mm and 0.55microns.  The 1mm results are  applicable  throughout
the sub-mm region.

The model

     i.  is based on the assumption of radial symmetry in the atmosphere,

    ii.  uses the formulae for refractive index as given, for example, by  Allen
         (  Astrophysical  Quantities  1973,  AQ3),  which  are  dependent  upon
         pressure, temperature and water vapour pressure (which  is  related  to
         relative humidity),

   iii.  uses mean profiles of temperature and pressure applicable to Hawaii  as
         derived  from  radio-sonde  data  made  available  by the local weather
         service,

    iv.  allows the temperature profile to vary  from  the  mean  profile  by  a
         constant at each altitude,

     v.  allows the pressure profile to vary from the mean profile by a constant
         percentage at each altitude,

    vi.  allows for the specification of any desired humidity profile.





                                     - 3 -
Refraction                                                                Page 4
MTIN026


     Refraction under any given atmospheric conditions and at any  elevation  is
then  determined by an integration along the light path, through the atmosphere.
While the temperature and pressure profiles are fairly well defined, and in  the
tropics  especially  seem to vary little from season to season, the humidity can
take many profiles.  However, experimentation early on in this work showed  that
the  refraction  was  essentially  independent of humidity profile, and depended
only upon the humidity at the altitude of the observer.  This is similar to  the
general  plane  parallel  medium  case  where the refraction depends only on the
indices at the ends of the light path.

     The ambient temperature and pressure are compared with the  nominal  values
from  the  mean  profiles ( 3degC and 624mb for the altitude of JCMT) to specify
the way the mean profiles are adjusted for the integration.

     The  integration  results  agree  very  well  with  the  values  quoted  by
Allen(AQ3,p125)  for  optical  refraction  under  standard  conditions from sea-
level, and with Ulich's(1980, Intl.  J.  of I-R and Mm Waves Vol 2  No  2  p293)
values  for  (sub)-millimeter  refraction  from  an  altitude of 2km, so we have
confidence in the model.

     Assuming, as is generally held, that refraction takes the general form

              Ref  =  A tanZ + B (tanZ)**3


     where Z is the zenith distance ( and E is the elevation),  the  essence  of
producing  the algorithm is in determining A and B.  By allowing the atmospheric
parameters (T,p,and h) to  vary  separately  and  in  pairs  and  by  performing
integrations  through  the  atmosphere  at  45degs  elevation  it is possible to
determine the form of A, and by integrations at low elevations to determine  the
form  of  B.   Because  the  refraction  behaves  almost  exponentially  at  low
elevations the applicability of any derived form of B, which  transpires  to  be
primarily  elevation  dependent,  depends  very  sensitively  upon  the range of
elevation covered by the experiments.  An elevation limit of 5degrees was chosen
and above this elevation B, it will be seen, is well described by a second order
polynomial in elevation.  Below this elevation the errors quickly grow  and  are
available as a set of look-up Tables.















                                     - 4 -
Refraction                                                                Page 5
MTIN026



     We find
          A = C0 + C1*(h-20) + C2*p + C3*T + C4*T**2 + cross-terms
     where
                       1mm                0.55microns

         C0 =        37.823                 37.080
         C1 =         0.0681                -0.0006
         C2 =         0.371                  0.371
         C3 =        -0.133                 -0.137
         C4 =         0.00047                0.00047

    and the cross-terms are

               h(0.004433*T + 0.000133*T**2 + 0.000002*T**3)  for   1mm
       and    -0.001333*p*T                                   for  0.55microns


     and
          B = D0  +  D1*E  +  D2*E**2
    where
         D0 =        -0.0242                  -0.0238
         D1 =        -0.00212                 -0.00227
         D2 =         0.0000676                0.0000819

          E is the elevation in degrees
          T (degC) is the ambient temperature
          h (%)    is the ambient relative humidity
     and  p (%)    is the ambient pressure difference from nominal
                            (624mb for the altitude of JCMT).


     The formula reproduces the integrations through the  atmosphere  to  within
about  half  an arcsecond for elevations above 10degrees and under most expected
conditions of the atmosphere.  The errors increase towards lower elevations  and
with increasingly abnormal atmospheric conditions.  Tables are available showing
these errors or may be constructed upon request.

     Tables are given in an appendix,giving the values of A  for  the  range  of
expected atmospheric conditions.












                                     - 5 -
Refraction                                                                Page 6
MTIN026


2.2  Implementation


     The Tel1 actions Connect and Refraction have been introduced.
     The Connect action reads the name of the Environment monitoring  task  from
the ADAM parameter system; if this is "Disable" it prepares to read "default" or
"user-specified" values of ambient pressure, temperature and humidity  from  the
ADAM  parameter  system.   Otherwise  it prepares to read to obtain these values
from the environment monitoring task.  The former mode is used at the moment.
     The Refraction action obtains  the  environment  parameters  and  computes,
according  to  the value of "refraction_defn", the values of A and the constants
for the computation of B (which is elevation dependent).
     The "refraction_defn" parameter may have three values,
     1.  TFILE - compute the refraction correction according to the first  model
         using the telescope.dat coefficients.
     2.  RADIO - compute the refraction corrections using the set  of  constants
         for 1mm observing.
     3.  OPTICAL - compute the refraction corrections using the set of constants
         for 0.55 micron observing.

     The refraction correction constants c0 to c4 and d0 to d4 are held  in  the
include file TEL_REFRACTION.  (These may later be added to telescope.dat).
     The REFR array held in the CDA has been extended to hold:
     1.  11,12,13 - constants D0,D1,D2, converted to appropriate units.
     2.  14, refraction definition  code  and  column  of  refraction  constants
         table.   These  are determined from the value of refraction_defn by the
         TEL_REFRACTION routine.


     The  routine  drive_refg2a  has  been  modified  to  compute  the  altitude
correction according to the refraction definition in use.
     A procedure, USER_REFRACTION,  is  available  for  setting  the  refraction
correction using user specified values of the environment parameters.



















                                     - 6 -












                                   APPENDIX A

                             REFRACTION DATA TABLE




                     Values of the refraction parameter  A
                  applicable to the 4.1km altitude of  J C M T
                           Wavelength = 1000.0  micron

     T(deg C) is the ambient temperature
     dp(%)    is the difference between ambient pressure and 624mb
      H(%)    is the ambient relative humidity

     B  =  - 0.0242  - 0.00212*E  + 0.0000676*E**2

     where  E is the elevation  =  90 - Z
       and  Z is the zenith distance

     and refraction  is   A tanZ + B (tanZ)**3

                                  dp =  -3%
     H
          T     -20   -15   -10    -5     0     5    10    15    20

     0          38.1  37.4  36.7  36.0  35.3  34.7  34.1  33.5  32.9
    10          38.3  37.6  37.0  36.5  36.0  35.6  35.4  35.2  35.2
    20          38.5  37.9  37.4  37.0  36.7  36.6  36.7  36.9  37.5
    30          38.6  38.1  37.7  37.5  37.4  37.5  37.9  38.6  39.7
    40          38.8  38.3  38.1  38.0  38.1  38.5  39.2  40.3  42.0
    50          38.9  38.6  38.4  38.4  38.8  39.4  40.5  42.1  44.3
    60          39.1  38.8  38.8  38.9  39.4  40.3  41.8  43.8  46.5
    70          39.3  39.1  39.1  39.4  40.1  41.3  43.0  45.5  48.8
    80          39.4  39.3  39.4  39.9  40.8  42.2  44.3  47.2  51.1
    90          39.6  39.5  39.8  40.4  41.5  43.2  45.6  48.9  53.3








                                     - 7 -
Refraction                                                              Page A-2
MTIN026



                                  dp =  -2%
     H
          T     -20   -15   -10    -5     0     5    10    15    20

     0          38.5  37.8  37.0  36.4  35.7  35.1  34.4  33.8  33.3
    10          38.7  38.0  37.4  36.8  36.4  36.0  35.7  35.6  35.5
    20          38.8  38.3  37.7  37.3  37.1  36.9  37.0  37.3  37.8
    30          39.0  38.5  38.1  37.8  37.8  37.9  38.3  39.0  40.1
    40          39.2  38.7  38.4  38.3  38.4  38.8  39.5  40.7  42.3
    50          39.3  39.0  38.8  38.8  39.1  39.8  40.8  42.4  44.6
    60          39.5  39.2  39.1  39.3  39.8  40.7  42.1  44.1  46.9
    70          39.7  39.5  39.5  39.8  40.5  41.7  43.4  45.8  49.2
    80          39.8  39.7  39.8  40.3  41.2  42.6  44.7  47.5  51.4
    90          40.0  39.9  40.2  40.8  41.8  43.5  45.9  49.3  53.7


                                  dp =  -1%

          T     -20   -15   -10    -5     0     5    10    15    20

     0          38.9  38.2  37.4  36.7  36.1  35.4  34.8  34.2  33.6
    10          39.1  38.4  37.8  37.2  36.8  36.4  36.1  35.9  35.9
    20          39.2  38.6  38.1  37.7  37.4  37.3  37.3  37.6  38.2
    30          39.4  38.9  38.5  38.2  38.1  38.2  38.6  39.3  40.4
    40          39.6  39.1  38.8  38.7  38.8  39.2  39.9  41.0  42.7
    50          39.7  39.3  39.2  39.2  39.5  40.1  41.2  42.8  45.0
    60          39.9  39.6  39.5  39.7  40.2  41.1  42.5  44.5  47.2
    70          40.0  39.8  39.8  40.2  40.8  42.0  43.7  46.2  49.5
    80          40.2  40.1  40.2  40.7  41.5  42.9  45.0  47.9  51.8
    90          40.4  40.3  40.5  41.1  42.2  43.9  46.3  49.6  54.0


                                  dp =   0%

          T     -20   -15   -10    -5     0     5    10    15    20

     0          39.3  38.5  37.8  37.1  36.4  35.8  35.1  34.5  34.0
    10          39.5  38.8  38.2  37.6  37.1  36.7  36.4  36.3  36.2
    20          39.6  39.0  38.5  38.1  37.8  37.7  37.7  38.0  38.5
    30          39.8  39.3  38.8  38.6  38.5  38.6  39.0  39.7  40.8
    40          40.0  39.5  39.2  39.1  39.2  39.5  40.3  41.4  43.0
    50          40.1  39.7  39.5  39.5  39.8  40.5  41.5  43.1  45.3
    60          40.3  40.0  39.9  40.0  40.5  41.4  42.8  44.8  47.6
    70          40.4  40.2  40.2  40.5  41.2  42.4  44.1  46.5  49.8
    80          40.6  40.5  40.6  41.0  41.9  43.3  45.4  48.2  52.1
    90          40.8  40.7  40.9  41.5  42.6  44.2  46.6  50.0  54.4





                                     - 8 -
Refraction                                                              Page A-3
MTIN026



                                  dp =   1%
     H
          T     -20   -15   -10    -5     0     5    10    15    20

     0          39.7  38.9  38.2  37.5  36.8  36.1  35.5  34.9  34.3
    10          39.8  39.2  38.5  38.0  37.5  37.1  36.8  36.6  36.6
    20          40.0  39.4  38.9  38.5  38.2  38.0  38.0  38.3  38.8
    30          40.2  39.6  39.2  39.0  38.8  39.0  39.3  40.0  41.1
    40          40.3  39.9  39.6  39.4  39.5  39.9  40.6  41.7  43.4
    50          40.5  40.1  39.9  39.9  40.2  40.8  41.9  43.5  45.6
    60          40.7  40.4  40.3  40.4  40.9  41.8  43.2  45.2  47.9
    70          40.8  40.6  40.6  40.9  41.6  42.7  44.4  46.9  50.2
    80          41.0  40.8  41.0  41.4  42.3  43.7  45.7  48.6  52.4
    90          41.2  41.1  41.3  41.9  43.0  44.6  47.0  50.3  54.7


                                  dp =   2%

          T     -20   -15   -10    -5     0     5    10    15    20

     0          40.1  39.3  38.6  37.8  37.2  36.5  35.8  35.2  34.6
    10          40.3  39.5  38.9  38.3  37.8  37.4  37.1  36.9  36.9
    20          40.4  39.8  39.3  38.8  38.5  38.4  38.4  38.7  39.2
    30          40.6  40.0  39.6  39.3  39.2  39.3  39.7  40.4  41.4
    40          40.7  40.3  40.0  39.8  39.9  40.3  41.0  42.1  43.7
    50          40.9  40.5  40.3  40.3  40.6  41.2  42.2  43.8  46.0
    60          41.1  40.8  40.6  40.8  41.3  42.1  43.5  45.5  48.2
    70          41.2  41.0  41.0  41.3  41.9  43.1  44.8  47.2  50.5
    80          41.4  41.2  41.3  41.8  42.6  44.0  46.1  48.9  52.8
    90          41.6  41.5  41.7  42.3  43.3  45.0  47.3  50.6  55.0


                                  dp =   3%

          T     -20   -15   -10    -5     0     5    10    15    20

     0          40.5  39.7  38.9  38.2  37.5  36.8  36.2  35.6  35.0
    10          40.6  39.9  39.3  38.7  38.2  37.8  37.5  37.3  37.2
    20          40.8  40.2  39.6  39.2  38.9  38.7  38.8  39.0  39.5
    30          41.0  40.4  40.0  39.7  39.6  39.7  40.0  40.7  41.8
    40          41.1  40.7  40.3  40.2  40.3  40.6  41.3  42.4  44.0
    50          41.3  40.9  40.7  40.7  40.9  41.5  42.6  44.1  46.3
    60          41.5  41.1  41.0  41.2  41.6  42.5  43.9  45.8  48.6
    70          41.6  41.4  41.4  41.7  42.3  43.4  45.1  47.6  50.8
    80          41.8  41.6  41.7  42.1  43.0  44.4  46.4  49.3  53.1
    90          42.0  41.8  42.0  42.6  43.7  45.3  47.7  51.0  55.4





                                     - 9 -
